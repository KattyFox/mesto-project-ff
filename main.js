/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";var t=document.querySelector(".popup__form"),e=t.querySelector(".popup__input"),n=(t.querySelector(".".concat(null==e?void 0:e.id,"-error")),function(t,e,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n.inputErrorClass),r.classList.remove(n.errorClass),r.textContent=""}),r=function(t){Array.from(document.querySelectorAll(t.formSelector)).forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault()})),function(t,e){var r=Array.from(t.querySelectorAll(e.inputSelector)),o=e;r.forEach((function(e){e.addEventListener("input",(function(){!function(t,e,r){if(e.validity.patternMismatch){var o=e.getAttribute("data-error-message");void 0!==o&&e.setCustomValidity(o)}else e.setCustomValidity("");e.validity.valid?n(t,e,r):function(t,e,n,r){var o=t.querySelector(".".concat(e.id,"-error"));e.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(t,e,e.validationMessage,r)}(t,e,o)}))}))}(e,t)}))};function o(t){var e=document.querySelector(".popup_is-opened");("Escape"===t.key||t.target.classList.contains("popup__close")||t.target===e)&&e&&c(e)}function i(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",o),document.addEventListener("click",o)}function c(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",o),document.removeEventListener("click",o)}function u(t,e){t?(e.removeAttribute("disabled"),e.classList.remove("popup__button_disabled")):(e.setAttribute("disabled",!0),e.classList.add("popup__button_disabled"))}function a(t,e){e.innerHTML=t?"Сохранение ...":"Сохранить"}function l(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return s(l,"_invoke",function(n,r,o){var i,u,a,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,a=t,f.n=n,c}};function d(n,r){for(u=n,a=r,e=0;!p&&l&&!o&&e<s.length;e++){var o,i=s[e],d=f.p,y=i[2];n>3?(o=y===r)&&(a=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,f.v=r,f.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,f.n=y,u=0))}if(o||n>1)return c;throw p=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,y),u=s,a=y;(e=u<2?t:a)||!p;){i||(u?u<3?(u>1&&(f.n=-1),d(u,a)):f.n=a:f.v=a);try{if(l=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(p=f.n<0)?a:n.call(r,f))!==c)break}catch(e){i=t,u=1,a=e}finally{l=1}}return{value:e,done:p}}}(n,o,i),!0),l}var c={};function u(){}function a(){}function p(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(s(e={},r,(function(){return this})),e),d=p.prototype=u.prototype=Object.create(f);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,s(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return a.prototype=p,s(d,"constructor",p),s(p,"constructor",a),a.displayName="GeneratorFunction",s(p,o,"GeneratorFunction"),s(d),s(d,o,"Generator"),s(d,r,(function(){return this})),s(d,"toString",(function(){return"[object Generator]"})),(l=function(){return{w:i,m:y}})()}function s(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}s=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){s(t,e,(function(t){return this._invoke(e,n,t)}))}i("next",0),i("throw",1),i("return",2)}},s(t,e,n,r)}function p(t,e,n,r,o,i,c){try{var u=t[i](c),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){p(i,r,o,c,u,"next",t)}function u(t){p(i,r,o,c,u,"throw",t)}c(void 0)}))}}var d="https://nomoreparties.co/v1/wff-cohort-41",y="/users/me",v="/cards",_="/likes";function m(){return h.apply(this,arguments)}function h(){return(h=f(l().m((function t(){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+y,{headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b"}}))}),t)})))).apply(this,arguments)}function b(){return k.apply(this,arguments)}function k(){return(k=f(l().m((function t(){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+v,{headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b"}}))}),t)})))).apply(this,arguments)}function S(){return(S=f(l().m((function t(e,n){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+y,{method:"PATCH",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}))}),t)})))).apply(this,arguments)}function g(){return(g=f(l().m((function t(e,n){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+v,{method:"POST",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}))}),t)})))).apply(this,arguments)}function L(){return(L=f(l().m((function t(e){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+v+"/"+e,{method:"DELETE",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"}}))}),t)})))).apply(this,arguments)}function q(t){return E.apply(this,arguments)}function E(){return(E=f(l().m((function t(e){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+v+_+"/"+e,{method:"PUT",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"}}))}),t)})))).apply(this,arguments)}function w(t){return T.apply(this,arguments)}function T(){return(T=f(l().m((function t(e){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+v+_+"/"+e,{method:"DELETE",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"}}))}),t)})))).apply(this,arguments)}function j(){return(j=f(l().m((function t(e){return l().w((function(t){for(;;)if(0===t.n)return t.a(2,fetch(d+y+"/avatar",{method:"PATCH",headers:{authorization:"ca9c73cd-774d-4dee-9109-08215140258b","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}))}),t)})))).apply(this,arguments)}function C(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var a=r&&r.prototype instanceof u?r:u,l=Object.create(a.prototype);return O(l,"_invoke",function(n,r,o){var i,u,a,l=0,s=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,u=0,a=t,f.n=n,c}};function d(n,r){for(u=n,a=r,e=0;!p&&l&&!o&&e<s.length;e++){var o,i=s[e],d=f.p,y=i[2];n>3?(o=y===r)&&(a=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(u=0,f.v=r,f.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,f.n=y,u=0))}if(o||n>1)return c;throw p=!0,r}return function(o,s,y){if(l>1)throw TypeError("Generator is already running");for(p&&1===s&&d(s,y),u=s,a=y;(e=u<2?t:a)||!p;){i||(u?u<3?(u>1&&(f.n=-1),d(u,a)):f.n=a:f.v=a);try{if(l=2,i){if(u||(o="next"),e=i[o]){if(!(e=e.call(i,a)))throw TypeError("iterator result is not an object");if(!e.done)return e;a=e.value,u<2&&(u=0)}else 1===u&&(e=i.return)&&e.call(i),u<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=t}else if((e=(p=f.n<0)?a:n.call(r,f))!==c)break}catch(e){i=t,u=1,a=e}finally{l=1}}return{value:e,done:p}}}(n,o,i),!0),l}var c={};function u(){}function a(){}function l(){}e=Object.getPrototypeOf;var s=[][r]?e(e([][r]())):(O(e={},r,(function(){return this})),e),p=l.prototype=u.prototype=Object.create(s);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,O(t,o,"GeneratorFunction")),t.prototype=Object.create(p),t}return a.prototype=l,O(p,"constructor",l),O(l,"constructor",a),a.displayName="GeneratorFunction",O(l,o,"GeneratorFunction"),O(p),O(p,o,"Generator"),O(p,r,(function(){return this})),O(p,"toString",(function(){return"[object Generator]"})),(C=function(){return{w:i,m:f}})()}function O(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}O=function(t,e,n,r){if(e)o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n;else{function i(e,n){O(t,e,(function(t){return this._invoke(e,n,t)}))}i("next",0),i("throw",1),i("return",2)}},O(t,e,n,r)}function P(t,e,n,r,o,i,c){try{var u=t[i](c),a=u.value}catch(t){return void n(t)}u.done?e(a):Promise.resolve(a).then(r,o)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){P(i,r,o,c,u,"next",t)}function u(t){P(i,r,o,c,u,"throw",t)}c(void 0)}))}}!function(){var t,e,o=document.querySelector(".places__list"),l=document.querySelector(".popup__deletable_edit"),s=l.querySelector(".popup__button"),p=document.forms["edit-profile"],f=p.elements["my-name"],d=p.elements.description,y=document.querySelector(".profile__title"),v=document.querySelector(".profile__image"),_=document.querySelector(".profile__description"),h=p.querySelector(".popup__button"),k=document.querySelector(".profile__add-button"),E=document.querySelector(".popup_type_new-card"),T=document.forms["new-place"],O=T.elements["place-name"],P=T.elements.link,G=T.querySelector(".popup__button"),A=document.querySelector(".popup_type_edit"),V=document.querySelector(".profile__edit-button"),D=A.querySelector(".popup__button"),H=A.querySelector(".popup__input_type_name"),z=A.querySelector(".popup__input_type_description"),I=document.querySelector(".popup_avatar_edit"),M=document.querySelector(".avatar__edit-button"),F=I.querySelector(".popup__input_type_url"),N=I.querySelector(".popup__button"),B={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},J=document.querySelector(".popup_type_image");function U(t,e,n,r,o,i,c){var u=function(t){var e=document.getElementById("card-template").content.cloneNode(!0);e.querySelector(".card__image").src=t.link,e.querySelector(".card__image").alt=t.name,e.querySelector(".card__title").textContent=t.name;var n=e.querySelector(".likes__on__card");n.innerHTML=t.likes.length;var r=e.querySelector(".card__like-button"),o=e.querySelector(".places__item");void 0===o.dataset.cardId&&(o.dataset.cardId=t.id);var i=e.querySelector(".card__delete-button");return t.canBeDeleted?i.addEventListener("click",(function(e){t.onDelete(o.dataset.cardId,e.target.closest(".card"))})):i.style.visibility="hidden",r.addEventListener("click",(function(e){var r=n;e.target.classList.contains("card__like-button_is-active")?t.onUnLike(o.dataset.cardId,r):t.onLike(o.dataset.cardId,r),e.target.classList.toggle("card__like-button_is-active")})),t.isLiked&&r.classList.toggle("card__like-button_is-active"),e}({name:t,link:e,likes:r,canBeDeleted:o,id:i,onDelete:K,onLike:Q,isLiked:c,onUnLike:W});n.prepend(u)}function K(t,e){i(l),s.addEventListener("click",(function(){e.remove(),c(l),function(t){L.apply(this,arguments)}(t)}))}function Q(t,e){return R.apply(this,arguments)}function R(){return(R=x(C().m((function t(e,n){var r,o;return C().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,q(e);case 1:return r=t.v,t.n=2,r.json();case 2:o=t.v,n.innerHTML=o.likes.length;case 3:return t.a(2)}}),t)})))).apply(this,arguments)}function W(t,e){return X.apply(this,arguments)}function X(){return(X=x(C().m((function t(e,n){var r,o;return C().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,w(e);case 1:return r=t.v,t.n=2,r.json();case 2:o=t.v,n.innerHTML=o.likes.length;case 3:return t.a(2)}}),t)})))).apply(this,arguments)}function Y(){return Y=x(C().m((function t(){var e,n,i,c,u;return C().w((function(t){for(;;)switch(t.n){case 0:return u=function(){return(u=x(C().m((function t(){var n;return C().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,b();case 1:if(!(n=t.v).ok){t.n=3;break}return t.n=2,n.json();case 2:t.v.forEach((function(t){U(t.name,t.link,o,t.likes,t.owner._id===e,t._id,t.likes.some((function(t){return t._id===e})))})),t.n=4;break;case 3:alert("Ошибка HTTP: "+n.status);case 4:return t.a(2)}}),t)})))).apply(this,arguments)},c=function(){return u.apply(this,arguments)},i=function(){return(i=x(C().m((function t(){var n,r;return C().w((function(t){for(;;)switch(t.n){case 0:return t.n=1,m();case 1:if(!(n=t.v).ok){t.n=3;break}return t.n=2,n.json();case 2:r=t.v,y.innerHTML=r.name,_.innerHTML=r.about,v.style.backgroundImage="url(".concat(r.avatar,")"),e=r._id,t.n=4;break;case 3:alert("Ошибка HTTP: "+n.status);case 4:return t.a(2)}}),t)})))).apply(this,arguments)},n=function(){return i.apply(this,arguments)},e="",r(B),t.n=1,n();case 1:return t.n=2,c();case 2:return t.a(2)}}),t)}))),Y.apply(this,arguments)}J&&(t=J.querySelector(".popup__image"),e=J.querySelector(".popup__caption")),p.addEventListener("submit",(function(t){t.preventDefault(),y.textContent=f.value,_.textContent=d.value,u(!1,h),a(!0,h),function(t,e){return S.apply(this,arguments)}(f.value,d.value).finally((function(){a(!1,h),c(A)}))})),V.addEventListener("click",(function(){f.value=y.textContent,d.value=_.textContent,u(!0,D),i(A)})),M.addEventListener("click",(function(){F.value="",F.checkValidity(),u(!1,N),i(I)})),I.addEventListener("input",(function(){u(F.checkValidity(),N)})),I.addEventListener("submit",(function(t){t.preventDefault();var e=F.value;v.style.backgroundImage="url(".concat(e,")"),u(!1,N),a(!0,N),function(t){return j.apply(this,arguments)}(e).finally((function(){a(!1,N),c(I)}))})),E.querySelector(".popup__close").addEventListener("click",(function(){c(E)})),k.addEventListener("click",(function(){i(E),function(t,e){var r=Array.from(t.querySelectorAll(".popup__input"));t.querySelector(".popup__button"),r.forEach((function(r){n(t,r,e),r.setCustomValidity(""),r.value=""}))}(E,B),u(O.checkValidity()&&P.checkValidity(),G)})),T.addEventListener("submit",(function(t){t.preventDefault();var e=O.value,n=P.value;a(!0,G),function(t,e){return g.apply(this,arguments)}(e,n).finally((function(){a(!1,G),T.reset(),c(E),u(!1,G)}))})),T.addEventListener("input",(function(){u(O.checkValidity()&&P.checkValidity(),G)})),A.addEventListener("input",(function(){u(H.checkValidity()&&z.checkValidity(),D)})),o.addEventListener("click",(function(n){if(n.target.classList.contains("card__image")){var r=n.target.closest(".card").querySelector(".card__title"),o={link:n.target.src,name:n.target.alt||r.textContent};t.src=o.link,t.alt=o.name,e.textContent=o.name,i(J)}})),function(){Y.apply(this,arguments)}()}()})();